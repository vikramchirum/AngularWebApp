<section *ngIf="ActiveOfferDetails">
  <div class="row col-md-12" *ngIf="IsCurrentPlanPopOver">
    <h4><b>{{ActiveOfferDetails?.Current_Offer.Product_Name}} (Current plan)</b></h4>
    <hr>
  </div>
  <div class="service-upgrade-modal" >
    <!-- need this for modal, not popover
     <div class="plan-header"><h3 class="plan-title ">{{ActiveOfferDetails.Current_Offer.Product_Name}}</h3></div>
     -->
    <h3 class="text-center plan-info">{{Price_atFeatured_Usage_Level_Current | DollarToCentsPipe | number: '1.1-1'}}<sup>&cent;</sup> per KWh</h3>
    <p class="text-center">AT {{Featured_Usage_Level}}</p>
    <hr>
    <div class="row plan-documents">
      <div class="col-md-12">
        <h4>Plan Documents</h4>
      </div>
      <div class="col-md-4 clearfix">
        <div class="col-xs-2 col-md-12 text-center">
          <i class="fa fa-file-pdf-o fa-fw fa-in-circle"></i>
        </div>
        <div class="col-xs-10 col-md-12"><small><br class="visible-xs"><a  href="{{eflLink}}" (click)="viewEFL(false)" target="_blank">Electricty Facts Label</a></small></div>
      </div>
      <div class="col-md-4 clearfix">
        <div class="col-xs-2 col-md-12 text-center">
          <i class="fa fa-file-pdf-o fa-fw fa-in-circle"></i>
        </div>
        <div class="col-xs-10 col-md-12"><small><br class="visible-xs"><a href="{{yraacLink}}" (click)="viewYraac()" target="_blank">Your Rights as a Customer</a></small></div>
      </div>
      <div class="col-md-4 clearfix">
        <div class="col-xs-2 col-md-12 text-center">
          <i class="fa fa-file-pdf-o fa-fw fa-in-circle"></i>
        </div>
        <div class="col-xs-10 col-md-12"><small><br class="visible-xs"><a href="{{tosLink}}" (click)="viewTos()" target="_blank">Terms of Service</a></small></div>
      </div>
    </div>
    <hr>
    <div class="row">
      <div class="col-md-12">
        <h4>Cost Components</h4>
        <h5>Gexa Energy</h5>
        <table border="0" width="100%" class="table-condensed table-striped">
          <tbody>
          <tr *ngFor="let charge of ActiveOfferDetails.Current_Offer.Energy_Charges">
            <td class="bill-name">Energy Charges<small>
              <ng-template *ngIf="charge.Min === 0 && charge.Max === null; then OnlyMin"></ng-template>
              <ng-template *ngIf="charge.Min > 0 && charge.Max === null; then NonZeroMin"></ng-template>
              <!--<ng-template *ngIf="charge.Max >= 0 && charge.Min === ''; then OnlyMax"></ng-template>-->
              <ng-template *ngIf="charge.Min >= 0 && charge.Max > 0; then MinMax"></ng-template>
            </small></td>
            <ng-template #OnlyMin></ng-template>
            <ng-template #NonZeroMin> ( >= {{charge.Min}} kWh)</ng-template>
            <!--<ng-template #OnlyMax> ( >= {{charge.Max}} kWh)</ng-template>-->
            <ng-template #MinMax> ({{charge.Min}} - {{charge.Max}} kWh) </ng-template>
            <td class="bill-amount">${{charge.Amount | number: kWhAmountFormatter }}  per kWh</td>
          </tr>
          <tr *ngFor="let charge of ActiveOfferDetails.Current_Offer.Usage_Charges">
            <td class="bill-name">Monthly Usage Charges<small>
              <ng-template *ngIf="charge.Min === 0 && charge.Max === null; then OnlyMin"></ng-template>
              <ng-template *ngIf="charge.Min > 0 && charge.Max === null; then NonZeroMin"></ng-template>
              <!--<ng-template *ngIf="charge.Max >= 0 && charge.Min === ''; then OnlyMax"></ng-template>-->
              <ng-template *ngIf="charge.Min >= 0 && charge.Max > 0; then MinMax"></ng-template>
            </small></td>
            <ng-template #OnlyMin></ng-template>
            <ng-template #NonZeroMin> ( >= {{charge.Min}})</ng-template>
            <!--<ng-template #OnlyMax> ( >= {{charge.Max}})</ng-template>-->
            <ng-template #MinMax> ({{charge.Min}} - {{charge.Max}}) </ng-template>
            <td class="bill-amount">${{charge.Amount | number: dollarAmountFormatter }}</td>
          </tr>
          <tr *ngFor="let charge of ActiveOfferDetails.Current_Offer.Usage_Credits">
            <td class="bill-name">Monthly Usage Credits<small>
              <ng-template *ngIf="charge.Min === 0 && charge.Max === null; then OnlyMin"></ng-template>
              <ng-template *ngIf="charge.Min > 0 && charge.Max === null; then NonZeroMin"></ng-template>
              <!--<ng-template *ngIf="charge.Max >= 0 && charge.Min === ''; then OnlyMax"></ng-template>-->
              <ng-template *ngIf="charge.Min >= 0 && charge.Max > 0; then MinMax"></ng-template>
            </small></td>
            <ng-template #OnlyMin></ng-template>
            <ng-template #NonZeroMin> ( >= {{charge.Min}})</ng-template>
            <!--<ng-template #OnlyMax> ( >= {{charge.Max}})</ng-template>-->
            <ng-template #MinMax> ({{charge.Min}} - {{charge.Max}}) </ng-template>
            <td class="bill-amount">${{charge.Amount | number: dollarAmountFormatter }}</td>
          </tr>
          <tr *ngIf="ActiveOfferDetails.Current_Offer.Base_Charge">
            <td class="bill-name">Base Charge <small>(per month)</small></td>
            <td class="bill-amount">${{ActiveOfferDetails.Current_Offer.Base_Charge | number: dollarAmountFormatter }}*</td>
          </tr>
          </tbody>
        </table>
      </div>
      <div class="col-md-12">
        <h5>{{ActiveOfferDetails.TDU_Name}} (TDU)</h5>
        <table border="0" width="100%" class="table-condensed table-striped">
          <tbody>
          <tr>
            <td class="bill-name">TDU Delivery Charges <small>(per kWh)</small></td>
            <td class="bill-amount">${{ActiveOfferDetails.Current_Offer.Delivery_Charge | number: kWhAmountFormatter }}</td>
          </tr>
          <tr>
            <td class="bill-name">TDU Meter Charges <small>(per month)</small></td>
            <td class="bill-amount">${{ActiveOfferDetails.Current_Offer.Meter_Charge | number: dollarAmountFormatter }}</td>
          </tr>
          </tbody>
        </table>
      </div>

    </div>
    <div class="row bg-info">
      <div class="col-xs-6 col-md-6 text-center">
        <small><strong>Contract term</strong>
          <p>{{ActiveOfferDetails.Current_Offer.Term}} months</p></small>
      </div>
      <div class="col-xs-6 col-md-6 text-center">
        <small><strong>Cancel<span class="hidden-xs">lation</span> fee</strong>
          <p>${{ActiveOfferDetails.Current_Offer.Early_Termination_Fee}}</p></small>
      </div>
    </div>

  </div>

</section>

<section *ngIf="RenewalAccountDetails">
  <div class="row col-md-12">
    <h4><b>{{RenewalAccountDetails?.Existing_Renewal?.Offer?.Product_Name}}</b></h4>
    <hr>
  </div>
  <div class="service-upgrade-modal" >
    <!-- need this for modal, not popover
     <div class="plan-header"><h3 class="plan-title ">{{ActiveOfferDetails.Current_Offer.Product_Name}}</h3></div>
     -->
    <h3 class="text-center plan-info">{{Price_atFeatured_Usage_Level_Renewal | DollarToCentsPipe | number: '1.1-1'}}<sup>&cent;</sup> per KWh</h3>
    <p class="text-center">AT {{Featured_Usage_Level}}</p>
    <hr>
    <div class="row plan-documents">
      <div class="col-md-12">
        <h4>Plan Documents</h4>
      </div>
      <div class="col-md-4 clearfix">
        <div class="col-xs-2 col-md-12 text-center">
          <i class="fa fa-file-pdf-o fa-fw fa-in-circle"></i>
        </div>
        <div class="col-xs-10 col-md-12"><small><br class="visible-xs"><a href="{{eflLink}}" (click)="viewEFL(true)"  target="_blank">Electricty Facts Label</a></small></div>
      </div>
      <div class="col-md-4 clearfix">
        <div class="col-xs-2 col-md-12 text-center">
          <i class="fa fa-file-pdf-o fa-fw fa-in-circle"></i>
        </div>
        <div class="col-xs-10 col-md-12"><small><br class="visible-xs"><a href="{{yraacLink}}" (click)="viewYraac()"  target="_blank">Your Rights as a Customer</a></small></div>
      </div>
      <div class="col-md-4 clearfix">
        <div class="col-xs-2 col-md-12 text-center">
          <i class="fa fa-file-pdf-o fa-fw fa-in-circle"></i>
        </div>
        <div class="col-xs-10 col-md-12"><small><br class="visible-xs"><a href="{{tosLink}}" (click)="viewTos()"  target="_blank">Terms of Service</a></small></div>
      </div>
    </div>
    <hr>
    <div class="row">
      <div class="col-md-12">
        <h4>Cost Components</h4>
        <h5>Gexa Energy</h5>
        <table border="0" width="100%" class="table-condensed table-striped">
          <tbody>
          <tr *ngFor="let charge of RenewalAccountDetails?.Existing_Renewal?.Offer?.Energy_Charges">
            <td class="bill-name">Energy Charges<small>
              <ng-template *ngIf="charge.Min === 0 && charge.Max === null; then OnlyMin"></ng-template>
              <ng-template *ngIf="charge.Min > 0 && charge.Max === null; then NonZeroMin"></ng-template>
              <!--<ng-template *ngIf="charge.Max >= 0 && charge.Min === ''; then OnlyMax"></ng-template>-->
              <ng-template *ngIf="charge.Min >= 0 && charge.Max > 0; then MinMax"></ng-template>
            </small></td>
            <ng-template #OnlyMin></ng-template>
            <ng-template #NonZeroMin> ( >= {{charge.Min}} kWh)</ng-template>
            <!--<ng-template #OnlyMax> ( >= {{charge.Max}} kWh)</ng-template>-->
            <ng-template #MinMax> ({{charge.Min}} - {{charge.Max}} kWh) </ng-template>
            <td class="bill-amount">${{charge.Amount | number: kWhAmountFormatter }}  per kWh</td>
          </tr>
          <tr *ngFor="let charge of RenewalAccountDetails?.Existing_Renewal?.Offer?.Usage_Charges">
            <td class="bill-name">Monthly Usage Charges<small>
              <ng-template *ngIf="charge.Min === 0 && charge.Max === null; then OnlyMin"></ng-template>
              <ng-template *ngIf="charge.Min > 0 && charge.Max === null; then NonZeroMin"></ng-template>
              <!--<ng-template *ngIf="charge.Max >= 0 && charge.Min === ''; then OnlyMax"></ng-template>-->
              <ng-template *ngIf="charge.Min >= 0 && charge.Max > 0; then MinMax"></ng-template>
            </small></td>
            <ng-template #OnlyMin></ng-template>
            <ng-template #NonZeroMin> ( >= {{charge.Min}})</ng-template>
            <!--<ng-template #OnlyMax> ( >= {{charge.Max}})</ng-template>-->
            <ng-template #MinMax> ({{charge.Min}} - {{charge.Max}}) </ng-template>
            <td class="bill-amount">${{charge.Amount | number: dollarAmountFormatter }}</td>
          </tr>
          <tr *ngFor="let charge of RenewalAccountDetails?.Existing_Renewal?.Offer?.Usage_Credits">
            <td class="bill-name">Monthly Usage Credits<small>
              <ng-template *ngIf="charge.Min === 0 && charge.Max === null; then OnlyMin"></ng-template>
              <ng-template *ngIf="charge.Min > 0 && charge.Max === null; then NonZeroMin"></ng-template>
              <!--<ng-template *ngIf="charge.Max >= 0 && charge.Min === ''; then OnlyMax"></ng-template>-->
              <ng-template *ngIf="charge.Min >= 0 && charge.Max > 0; then MinMax"></ng-template>
            </small></td>
            <ng-template #OnlyMin></ng-template>
            <ng-template #NonZeroMin> ( >= {{charge.Min}})</ng-template>
            <!--<ng-template #OnlyMax> ( >= {{charge.Max}})</ng-template>-->
            <ng-template #MinMax> ({{charge.Min}} - {{charge.Max}}) </ng-template>
            <td class="bill-amount">${{charge.Amount | number: dollarAmountFormatter }}</td>
          </tr>
          <tr *ngIf="RenewalAccountDetails?.Existing_Renewal?.Offer?.Base_Charge">
            <td class="bill-name">Base Charge <small>(per month)</small></td>
            <td class="bill-amount">${{RenewalAccountDetails?.Existing_Renewal?.Offer?.Base_Charge | number: dollarAmountFormatter }}*</td>
          </tr>
          </tbody>
        </table>
      </div>
      <div class="col-md-12">
        <h5>{{RenewalAccountDetails?.Existing_Renewal?.Offer?.TDU_Name}} (TDU)</h5>
        <table border="0" width="100%" class="table-condensed table-striped">
          <tbody>
          <tr>
            <td class="bill-name">TDU Delivery Charges <small>(per kWh)</small></td>
            <td class="bill-amount">${{RenewalAccountDetails?.Existing_Renewal?.Offer?.Delivery_Charge | number: kWhAmountFormatter }}</td>
          </tr>
          <tr>
            <td class="bill-name">TDU Meter Charges <small>(per month)</small></td>
            <td class="bill-amount">${{RenewalAccountDetails?.Existing_Renewal?.Offer?.Meter_Charge | number: dollarAmountFormatter }}</td>
          </tr>
          </tbody>
        </table>
      </div>

    </div>
    <div class="row bg-info">
      <div class="col-xs-6 col-md-6 text-center">
        <small><strong>Contract term</strong>
          <p>{{RenewalAccountDetails?.Existing_Renewal?.Offer?.Term}} months</p></small>
      </div>
      <div class="col-xs-6 col-md-6 text-center">
        <small><strong>Cancel<span class="hidden-xs">lation</span> fee</strong>
          <p>${{RenewalAccountDetails?.Existing_Renewal?.Offer?.Early_Termination_Fee}}</p></small>
      </div>
    </div>
  </div>

</section>

<section *ngIf="OfferDetails">
    <div class="panel-group" id="accordion_{{OfferDetails.Id}}">
       <div class="panel panel-default">
         <div class="panel-heading">
           <h4 class="panel-title">
       <a data-toggle="collapse" [attr.data-parent]="'#accordion_'+OfferDetails.Id" href="#collapse1_{{OfferDetails.Id}}">
       What's Included</a>
     </h4>
         </div>
         <div id="collapse1_{{OfferDetails.Id}}" class="panel-collapse collapse in">
           <div class="panel-body Inc-p-o">
             <div *ngIf="(OfferDetails.Feature_List && OfferDetails.Feature_List.length > 0); then features else noFeatures"></div>
             <ng-template #features>
               <div *ngFor="let feature of OfferDetails.Feature_List">
                 <div class="row">
                   <div class="col-sm-2">
                     <i class="fa fa-lightbulb-o fa-fw fa-in-circle"></i>
                   </div>
                   <div class="col-sm-10" >
                     {{feature}}
                   </div>
                 </div>
                 <br>
               </div>
             </ng-template>
             <ng-template #noFeatures>
               <div class="col-sm-2">
                 <i class="fa fa-exclamation-triangle fa-fw fa-in-circle"></i>
               </div>
               <div class="col-sm-10">
                 No features available for this plan yet!
               </div>
               <br>
             </ng-template>
           </div>
         </div>
       </div>
       <div class="panel panel-default">
         <div class="panel-heading">
           <h4 class="panel-title">
       <a data-toggle="collapse" [attr.data-parent]="'#accordion_'+OfferDetails.Id" href="#collapse2_{{OfferDetails.Id}}">
       Plan Documents</a>
     </h4>
         </div>
         <div id="collapse2_{{OfferDetails.Id}}" class="panel-collapse collapse">
           <div class="panel-body">
             <div class="row doc-row">
               <div class="col-xs-4">
                 <i class="fa fa-2x fa-file-pdf-o"></i>
                 <small><a href="{{eflLink}}" (click)="viewEFL(null, OfferDetails.Rate_Code)" target="_blank">Electricty Facts Label</a></small>
               </div>
               <div class="col-xs-4">
                 <i class="fa fa-2x fa-file-pdf-o"></i>
                 <small><a href="{{yraacLink}}" (click)="viewYraac()" target="_blank">Your Rights as a Customer</a></small>
               </div>
               <div class="col-xs-4">
                 <i class="fa fa-2x fa-file-pdf-o"></i>
                 <small><a href="{{tosLink}}" (click)="viewTos()" target="_blank">Term and Conditions</a></small>
               </div>
             </div>

           </div>
         </div>
       </div>
       <div class="panel panel-default">
         <div class="panel-heading">
           <h4 class="panel-title">
       <a data-toggle="collapse" [attr.data-parent]="'#accordion_'+OfferDetails.Id" href="#collapse3_{{OfferDetails.Id}}">
       Cost Components</a>
     </h4>
         </div>
         <div id="collapse3_{{OfferDetails.Id}}" class="panel-collapse collapse">
           <div class="panel-body p-o">
             <div class="row cost-row">
               <div class="col-xs-12">
                 <strong>Gexa Energy</strong>
                 <!-- <p>

                   Energy Charges (0 - 999999999 kWh) <span class="pull-right">$0.0819 per kWh</span></p>
                 <p>
                   Base Charge (per month) <span class="pull-right">$9.95*</span></p> -->
                 <table border="0" width="100%" class="table-condensed table-striped">
                     <tbody>
                     <tr *ngFor="let charge of OfferDetails?.Actual_Pricing.Energy_Charges">
                       <td class="bill-name">Energy Charge<small>
                         <ng-template *ngIf="charge.Min === 0 && charge.Max === null; then OnlyMin"></ng-template>
                         <ng-template *ngIf="charge.Min > 0 && charge.Max === null; then NonZeroMin"></ng-template>
                         <!--<ng-template *ngIf="charge.Max >= 0 && charge.Min === ''; then OnlyMax"></ng-template>-->
                         <ng-template *ngIf="charge.Min >= 0 && charge.Max > 0; then MinMax"></ng-template>
                       </small></td>
                       <ng-template #OnlyMin></ng-template>
                       <ng-template #NonZeroMin> ( >= {{charge.Min}} kWh)</ng-template>
                       <!--<ng-template #OnlyMax> ( >= {{charge.Max}} kWh)</ng-template>-->
                       <ng-template #MinMax> ({{charge.Min}} - {{charge.Max}} kWh) </ng-template>
                       <td class="bill-amount">${{charge.Amount | number: kWhAmountFormatter }}  per kWh</td>
                     </tr>

                     <tr *ngFor="let charge of OfferDetails?.Actual_Pricing.Usage_Charges">
                       <td class="bill-name">Monthly Usage Charges<small>
                         <ng-template *ngIf="charge.Min === 0 && charge.Max === null; then OnlyMin"></ng-template>
                         <ng-template *ngIf="charge.Min > 0 && charge.Max === null; then NonZeroMin"></ng-template>
                         <!--<ng-template *ngIf="charge.Max >= 0 && charge.Min === ''; then OnlyMax"></ng-template>-->
                         <ng-template *ngIf="charge.Min >= 0 && charge.Max > 0; then MinMax"></ng-template>
                       </small></td>
                       <ng-template #OnlyMin>hi</ng-template>
                       <ng-template #NonZeroMin> ( >= {{charge.Min}})</ng-template>
                       <!--<ng-template #OnlyMax> ( >= {{charge.Max}})</ng-template>-->
                       <ng-template #MinMax> ({{charge.Min}} - {{charge.Max}}) </ng-template>
                       <td class="bill-amount">${{charge.Amount | number: dollarAmountFormatter }}</td>
                     </tr>

                     <tr *ngFor="let charge of OfferDetails?.Actual_Pricing.Usage_Credits">
                       <td class="bill-name">Monthly Usage Credits<small>
                         <ng-template *ngIf="charge.Min === 0 && charge.Max === null; then OnlyMin"></ng-template>
                         <ng-template *ngIf="charge.Min > 0 && charge.Max === null; then NonZeroMin"></ng-template>
                         <!--<ng-template *ngIf="charge.Max >= 0 && charge.Min === ''; then OnlyMax"></ng-template>-->
                         <ng-template *ngIf="charge.Min >= 0 && charge.Max > 0; then MinMax"></ng-template>
                       </small></td>
                       <ng-template #OnlyMin>hi</ng-template>
                       <ng-template #NonZeroMin> ( >= {{charge.Min}})</ng-template>
                       <!--<ng-template #OnlyMax> ( >= {{charge.Max}})</ng-template>-->
                       <ng-template #MinMax> ({{charge.Min}} - {{charge.Max}}) </ng-template>
                       <td *ngIf="charge.Min > 0 && charge.Max === ''">heloooooo</td>
                       <td class="bill-amount">${{charge.Amount | number: dollarAmountFormatter }}</td>
                     </tr>
                     <tr *ngIf="OfferDetails?.Actual_Pricing.Base_Charge">
                       <td class="bill-name">Base charge<small>(per month)</small></td>
                       <td class="bill-amount">${{OfferDetails?.Plan.Pricing_Definition.Base_Charge | number: dollarAmountFormatter }}*</td>
                     </tr>
                     </tbody>
                   </table>
                 <strong>{{OfferDetails.Plan.TDU.Name}} (TDU)</strong>
                 <!-- <p>
                   TDU Delivery Charges (per kWh) <span class="pull-right">$0.04</span>
                   <p>
                     TDU Meter Charges (per month) <span class="pull-right">$5.47</span></p>
                                         <p>
                     Some Charges (per month) <span class="pull-right">$5.47</span></p>
                                         <p>
                     Another Charges (per month) <span class="pull-right">$1.47</span></p>
                                         <p>
                     Charges (per month) <span class="pull-right">$2.47</span></p> -->
                 <table border="0" width="100%" class="table-condensed table-striped">
                   <tbody>
                   <tr>
                     <td class="bill-name">TDU delivery charges <small>(per kWh)</small></td>
                     <td class="bill-amount">${{OfferDetails.Plan.TDU.Delivery_Charge | number: kWhAmountFormatter }}</td>
                   </tr>
                   <tr>
                     <td class="bill-name">TDU meter charges <small>(per month)</small></td>
                     <td class="bill-amount">${{OfferDetails.Plan.TDU.Meter_Charge | number: dollarAmountFormatter }}</td>
                   </tr>
                   </tbody>
                 </table>
               </div>
             </div>

           </div>
         </div>
       </div>
       <div class="panel panel-default">
         <div class="panel-heading">
           <h4 class="panel-title">
       <a data-toggle="collapse" [attr.data-parent]="'#accordion_'+OfferDetails.Id" href="#collapse4_{{OfferDetails.Id}}">
       Term and Fees</a>
     </h4>
         </div>
         <div id="collapse4_{{OfferDetails.Id}}" class="panel-collapse collapse">
           <div class="panel-body">
             <div class="row terms-row">
               <div class="col-xs-6">
                 <strong>Contract Term</strong> {{OfferDetails?.Plan.Term}} months
               </div>
               <div class="col-xs-6">
                 <strong>Cancellation Fee</strong> ${{OfferDetails?.Actual_Pricing.Early_Termination_Fee}}
               </div>
             </div>

           </div>
         </div>
       </div>
       <div class="row buttons">
         <div class="pd-lf-10 pd-rt-10 col-xs-6">
           <button (click)="revertBack('#')" type="button" class="pd-lf-5 pd-rt-5 btn btn-block btn-success btn-back">
             <i class="fa fa-chevron-left"></i> BACK
           </button>
         </div>
         <div class="pd-lf-0 pd-rt-10 col-xs-6">
           <button (click)="revertBack('')" type="button" class="pd-lf-5 pd-rt-5 btn btn-block btn-success btn-select">
             SELECT PLAN <i class="fa fa-chevron-right"></i>
           </button>
         </div>
       </div>
     </div>
   </section>
